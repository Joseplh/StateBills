<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.19"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BoxSite: README</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BoxSite
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.19 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md__c___users__joseph_workspace__state_bills__box_site_frontend_node_modules_tarn__r_e_a_d_m_e.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">README </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a href="https://travis-ci.org/Vincit/tarn.js"><img src="https://travis-ci.org/Vincit/tarn.js.svg?branch=master" alt="Build Status" style="pointer-events: none;" class="inline"/></a></p>
<h2><a class="anchor" id="autotoc_md21062"></a>
Why yet another resource pool?</h2>
<p>Tarn is focused on robustness and ability to recover from errors. Tarn has timeouts for all operations that can fail or timeout so that you should never end up with pool full of crap. Tarn has a comprehensive test suite and we are committed to adding tests and fixing all bugs that are found.</p>
<p>Tarn will always remain simple.</p>
<h2><a class="anchor" id="autotoc_md21063"></a>
Install</h2>
<div class="fragment"><div class="line">npm install tarn</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md21064"></a>
Usage</h2>
<div class="fragment"><div class="line">const { Pool, TimeoutError } = require(&#39;tarn&#39;);</div>
<div class="line"> </div>
<div class="line">const pool = new Pool({</div>
<div class="line"> </div>
<div class="line">  // function that creates a resource. You can either pass the resource</div>
<div class="line">  // to the callback or return a promise that resolves the resource</div>
<div class="line">  // (but not both).</div>
<div class="line">  create: (cb) =&gt; {</div>
<div class="line">    cb(null, new SomeResource());</div>
<div class="line">  },</div>
<div class="line"> </div>
<div class="line">  // validates a connection before it is used. Return true or false</div>
<div class="line">  // from it. If false is returned, the resource is destroyed and a</div>
<div class="line">  // another one is acquired.</div>
<div class="line">  validate: (resource) =&gt; {</div>
<div class="line">    return true;</div>
<div class="line">  },</div>
<div class="line"> </div>
<div class="line">  // function that destroys a resource. This is always synchronous</div>
<div class="line">  // as nothing waits for the return value.</div>
<div class="line">  destroy: (someResource) =&gt; {</div>
<div class="line">    someResource.cleanup();</div>
<div class="line">  },</div>
<div class="line"> </div>
<div class="line">  // minimum size</div>
<div class="line">  min: 2,</div>
<div class="line"> </div>
<div class="line">  // maximum size</div>
<div class="line">  max: 10,</div>
<div class="line"> </div>
<div class="line">  // acquire promises are rejected after this many milliseconds</div>
<div class="line">  // if a resource cannot be acquired</div>
<div class="line">  acquireTimeoutMillis: 30000,</div>
<div class="line"> </div>
<div class="line">  // create operations are cancelled after this many milliseconds</div>
<div class="line">  // if a resource cannot be acquired</div>
<div class="line">  createTimeoutMillis: 30000,</div>
<div class="line"> </div>
<div class="line">  // destroy operations are awaited for at most this many milliseconds</div>
<div class="line">  // new resources will be created after this timeout</div>
<div class="line">  destroyTimeoutMillis: 5000,</div>
<div class="line"> </div>
<div class="line">  // free resouces are destroyed after this many milliseconds</div>
<div class="line">  idleTimeoutMillis: 30000,</div>
<div class="line"> </div>
<div class="line">  // how often to check for idle resources to destroy</div>
<div class="line">  reapIntervalMillis: 1000,</div>
<div class="line"> </div>
<div class="line">  // long long to idle after failed create before trying again</div>
<div class="line">  createRetryIntervalMillis: 200,</div>
<div class="line"> </div>
<div class="line">  // If true, when a create fails, the first pending acquire is</div>
<div class="line">  // rejected with the error. If this is false (the default) then</div>
<div class="line">  // create is retried until acquireTimeoutMillis milliseconds has</div>
<div class="line">  // passed.</div>
<div class="line">  propagateCreateError: false</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">// acquires a resource. The promise is rejected with `tarn.TimeoutError`</div>
<div class="line">// after `acquireTimeoutMillis` if a resource could not be acquired.</div>
<div class="line">const acquire = pool.acquire();</div>
<div class="line"> </div>
<div class="line">// acquire can be aborted using the abort method</div>
<div class="line">acquire.abort();</div>
<div class="line"> </div>
<div class="line">// the acquire object has a promise property that gets reolved with</div>
<div class="line">// the acquired resource</div>
<div class="line">try {</div>
<div class="line">  const resource = await acquire.promise;</div>
<div class="line">} catch (err) {</div>
<div class="line">  // if the acquire times out an error of class TimeoutError is thrown</div>
<div class="line">  if (err instanceof TimeoutError) {</div>
<div class="line">    console.log(&#39;timeout&#39;);</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">// releases the resource.</div>
<div class="line">pool.release(resource);</div>
<div class="line"> </div>
<div class="line">// returns the number of non-free resources</div>
<div class="line">pool.numUsed()</div>
<div class="line"> </div>
<div class="line">// returns the number of free resources</div>
<div class="line">pool.numFree()</div>
<div class="line"> </div>
<div class="line">// how many acquires are waiting for a resource to be released</div>
<div class="line">pool.numPendingAcquires()</div>
<div class="line"> </div>
<div class="line">// how many asynchronous create calls are running</div>
<div class="line">pool.numPendingCreates()</div>
<div class="line"> </div>
<div class="line">// waits for all resources to be returned to the pool and destroys them.</div>
<div class="line">// pool cannot be used after this.</div>
<div class="line">await pool.destroy();</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md21065"></a>
Changelog</h2>
<h3><a class="anchor" id="autotoc_md21066"></a>
1.1.5 2019-04-06</h3>
<ul>
<li>Added changelog #22</li>
<li>Handle opt.destroy() being a promise with destroyTimeout #16</li>
<li>Explicitly silence bluebird warnings #17</li>
<li>Add strict typings via TypeScript #10 </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.19 </li>
  </ul>
</div>
</body>
</html>
